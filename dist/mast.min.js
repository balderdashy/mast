!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){c.collectionEvents=function(){this.collection&&(this.listenTo(this.collection,"add",this.afterAdd),this.listenTo(this.collection,"remove",this.afterRemove),this.listenTo(this.collection,"reset",this.afterReset))},c.modelEvents=function(){this.model&&(this.listenTo(this.model,"change",function(a,b){_.isFunction(this.afterChange)&&this.afterChange(a,b)}),_.isObject(this.afterChange)&&_.each(this.afterChange,function(a,b){this.listenTo(this.model,"change:"+b,function(b,c){a.call(this,c)})},this))},c.globalTriggers=function(){var a=this;this.listenTo(FRAMEWORK,"all",function(b){var c=Array.prototype.slice.call(arguments);c.shift(),_.each(a.subscriptions,function(d,e){var f=Backbone.Router.prototype._extractParameters,g=Backbone.Router.prototype._routeToRegExp;e=e.replace(/\/*$/g,""),e=e.replace(/^([#~%])\/*/g,"$1");var h=g(e);if(b.match(h)){var i=f(h,b);if(!_.isFunction(d)&&(d=a[d],!d))throw new Error("Cannot trigger subscription because of unknown handler: "+d);d.apply(a,_.union(c,i))}})})}},{}],2:[function(a,b){var c=a("./helpers");b.exports=function(){FRAMEWORK.debug("Closed "+this.id+" component.");var a=this;this._rendering&&(a._renderingCanceled=!0,this.cancelRender(),a._rendering=!1),this._closing&&(this.cancelClose(),a._closing=!1),this._closing=!0,this.beforeClose(function(){a._closing=!1,c.emptyAllRegions.call(a),a.remove()})}},{"./helpers":3}],3:[function(a,b){var c=b.exports={emptyAllRegions:function(){_.each(this.regions,function(a,b){a.empty(),delete this.regions[b]},this)},renderRegions:function(){var a=this;c.emptyAllRegions();var b=this.$("region, [data-region]");b.each(function(b,c){var d=$(c).attr("default");d=d||$(c).attr("contents"),d=d||$(c).attr("template"),$(c).attr("contents",d);var e=FRAMEWORK.Region.fromElement(c,a);e.id||(e.id=""+FRAMEWORK.options.frameworkId+"__anonymous_region__"+a.anonymousRegionCounter,a.anonymousRegionCounter++),a.regions[e.id]=e,a[e.id]||(a[e.id]=e)})},compileTemplate:function(){var a=_.extend({get:function(b,c){var d=a[b];return"undefined"==typeof d&&(d=c),d}},FRAMEWORK.data);this.model&&_.extend(a,this.model.attributes);var b;try{b=_.isFunction(this.template)?this.template(a):_.template(this.template,a)}catch(c){var d=c,e="";c instanceof Error&&(d=c.toString(),e=c.stack),FRAMEWORK.error(this.id+" :: render() error in template :\n"+d+"\nTemplate :: "+b+"\n"+e),b=this.template}return b}}},{}],4:[function(a,b){var c=a("./lifecycleHooks"),d=a("./lifecycleEvents"),e=(a("./bindEvents"),a("./close")),f=a("./render"),g=a("./validateDefinition");Component=b.exports=Backbone.View.extend(),_.extend(Component.prototype,{beforeRender:function(a){c.beforeRender.call(this,a)},beforeClose:function(a){c.beforeClose.call(this,a)},afterRender:function(){c.afterRender.call(this)},cancelRender:function(){c.cancelRender.call(this)},cancelClose:function(){c.cancelClose.call(this)},afterChange:function(a,b){d.afterChange.call(this,a,b)},afterAdd:function(a,b,c){d.afterAdd.call(this,a,b,c)},afterRemove:function(a,b,c){d.afterRemove.call(this,a,b,c)},afterReset:function(a,b){d.afterReset.call(this,a,b)},close:function(){e.call(this)},render:function(a){f.call(this,a)}}),Component.prototype.initialize=function(a){this.anonymousRegionCounter=0,a=g(a),_.extend(this,a),this.regions={},_.bindAll(this)}},{"./bindEvents":1,"./close":2,"./lifecycleEvents":5,"./lifecycleHooks":6,"./render":7,"./validateDefinition":8}],5:[function(a,b,c){c.afterChange=function(){},c.afterAdd=function(){},c.afterRemove=function(){},c.afterReset=function(){}},{}],6:[function(a,b,c){c.beforeRender=function(a){a()},c.afterRender=function(){},c.beforeClose=function(a){a()},c.cancelRender=function(){FRAMEWORK.warn("cancelRender() should be defined if beforeClose(cb) or beforeRender(cb)are being used!")},c.cancelClose=function(){FRAMEWORK.warn("cancelClose() should be defined if beforeClose(cb) or beforeRender(cb)are being used!")}},{}],7:[function(a,b){var c=a("../utils/DOM"),d=a("./helpers"),e=a("./bindEvents");b.exports=function(a){FRAMEWORK.debug(this.id+" :---: Rendering component...");var b=this;this._rendering&&(FRAMEWORK.debug(this.id+" :: render() canceled."),this._renderingCanceled=!0,this.cancelRender(),this._rendering=!1),this._closing&&(FRAMEWORK.debug(this.id+" :: close() canceled."),this.cancelClose(),this._closing=!1),this._rendering=!0,this.beforeRender(function(){if(!b._renderingCanceled){if(e.collectionEvents.call(b),e.modelEvents.call(b),e.globalTriggers.call(b),b._rendering=!1,!b.$outlet)throw new Error(b.id+" :: Trying to render(), but no $outlet was defined!");var f=d.compileTemplate.call(b);if(!f)throw new Error(this.id+" :: Unable to render component because template compilation did not return any HTML.");f=f.replace(/^\s*/,""),f=f.replace(/\s*$/,""),f=f.replace(/(\r|\n)*/,""),f=f.replace(/(<!--.+-->)*/,""),f=f.replace(/^\s*/,""),f=f.replace(/\s*$/,""),f=f.replace(/(\r|\n)*/,"");var g=$.parseHTML(f),h=g[0];if(0===g.length)throw new Error(b.id+" :: render() ran into a problem rendering the template with HTML => \n"+f);(g.length>1||3===g[0].nodeType||$(g[0]).is("region"))&&(FRAMEWORK.log(b.id+" :: Wrapping template in <div/>...",g),h=$("<div/>").append(f),h=h[0]),b.setElement(h),d.renderRegions.call(b);var i=b.$outlet.children();_.isFinite(a)&&i.length>0&&i.length>a?i.eq(a).before(b.$el):b.$outlet.append(b.$el),b.afterRender(),b.attrFlags!==!1&&FRAMEWORK.attrFlags!==!1&&c.flagBoundEvents(b)}})}},{"../utils/DOM":27,"./bindEvents":1,"./helpers":3}],8:[function(a,b){b.exports=function(a){function b(b){var d=b[0].toUpperCase()+b.slice(1);!a[b]instanceof Backbone[d]&&(Framework.error("Component ("+c+") has an invalid "+b+"-- \n"+"If `"+b+"` is specified for a component, "+"it must be an *instance* of a Backbone."+d+".\n"),a[b]instanceof Backbone[d].constructor&&Framework.error("It looks like a Backbone."+d+" *prototype* was specified instead of a "+"Backbone."+d+" *instance*.\n"+"Please `new` up the "+b+" -before- "+Framework.id+".raise(),"+"or use a wrapper function to achieve the same effect, e.g.:\n"+"`"+b+": function () {\nreturn new Some"+d+"();\n}`"),Framework.warn("Ignoring invalid "+b+" :: "+a[b]),delete a[b])}if(_.isObject(a)){var c=this.id||a.id;return b("model"),b("collection"),_.clone(a)}return{}}},{}],9:[function(a,b){b.exports=function(a){var b=a.definition();if(a.idOverride){if(b.id)throw new Error(a.idOverride+":: Cannot specify an idOverride in .define() if an id property ("+b.id+") is already set in your component definition!\nUsage: .define([idOverride], definition)");b.id=a.idOverride}if(!b.id)throw new Error("Cannot use .define() without defining an id property or override in your component!\nUsage: .define([idOverride], definition)");FRAMEWORK.components[b.id]=b}},{}],10:[function(a,b){b.exports=function(a,b){b||(b=a,a=null),FRAMEWORK._defineQueue.push({definition:b,idOverride:a})}},{}],11:[function(a){var b=a("./define/index"),c=a("./region/index"),d=a("./component/index"),e=a("./raise/index");Framework=function(a){a=_.defaults(a,{throttleWindowResize:200,logLevel:"warn",frameworkId:"Mast",production:!1,logger:void 0,shortcut:{template:!0,count:!0}}),_.extend(this,Backbone,{options:a,templates:{},components:{},data:{},_defineQueue:[],regions:{}});var b=a.frameworkId;window[b]=this,FRAMEWORK=window[b]},Framework.prototype.Region=c,Framework.prototype.Component=d,Framework.prototype.define=b,Framework.prototype.raise=e},{"./component/index":4,"./define/index":10,"./raise/index":17,"./region/index":22}],12:[function(a,b){var c=a("./setup");b.exports=function(){c(FRAMEWORK.options.logLevel),_.isFunction(FRAMEWORK.__defineSetter__)&&FRAMEWORK.__defineSetter__("logLevel",function(a){c(a)})}},{"./setup":13}],13:[function(a,b){b.exports=function(a){var b=function(){};if(FRAMEWORK.logger)FRAMEWORK.error=FRAMEWORK.logger.error,FRAMEWORK.warn=FRAMEWORK.logger.warn,FRAMEWORK.log=FRAMEWORK.logger.debug||FRAMEWORK.logger,FRAMEWORK.verbose=FRAMEWORK.logger.verbose;else if("undefined"!=typeof console)if(_.isUndefined(console.log.bind))FRAMEWORK.error=b,FRAMEWORK.warn=b,FRAMEWORK.log=b,FRAMEWORK.debug=b,FRAMEWORK.verbose=b;else{switch(FRAMEWORK.error=console.error&&console.error.bind(console),FRAMEWORK.warn=console.warn&&console.warn.bind(console),FRAMEWORK.log=console.debug&&console.debug.bind(console),FRAMEWORK.verbose=console.log&&console.log.bind(console),a){case"verbose":break;case"debug":FRAMEWORK.verbose=b;break;case"warn":FRAMEWORK.verbose=FRAMEWORK.log=b;break;case"error":FRAMEWORK.verbose=FRAMEWORK.log=FRAMEWORK.warn=b;break;case"silent":FRAMEWORK.verbose=FRAMEWORK.log=FRAMEWORK.warn=FRAMEWORK.error=b;break;default:throw new Error("Unrecognized logging level config ("+FRAMEWORK.options.frameworkId+'.logLevel = "'+a+'")')}FRAMEWORK.debug=FRAMEWORK.log,FRAMEWORK.verbose("Log level set to :: ",a)}}},{}],14:[function(a,b){var c=a("../utils/shorthand"),d=a("../utils/utils"),e=a("../utils/events");b.exports=function(a,b){a.id||(a.id=b);var f=FRAMEWORK.templates[a.id];if(!f)return FRAMEWORK.warn(a.id+" :: No template found for component!"+"\nTemplates don't need a component unless you want interactivity, "+"every component *should* have a matching template!!"+"\nUsing components without templates may seem necessary, "+"but it's not.  It makes your view logic incorporeal, and makes your colleagues "+"uncomfortable.");FRAMEWORK.verbose(a.id+" :: Pairing component with template..."),a.template=f,a=d.objMap(a,c),a.events&&(a.events=d.objMap(a.events,c)),_.isObject(a.afterChange)&&!_.isFunction(a.afterChange)&&(a.afterChange=d.objMap(a.afterChange,c)),FRAMEWORK.verbose(a.id+" :: Building component prototype...");var g=FRAMEWORK.Component.extend(a);g.prototype.subscriptions={},_.each(g.prototype,function(b,c){var d=c.match(e["/DOMEvent/"]);if(d&&(d[1],d[3],g.prototype.events=g.prototype.events||{},g.prototype.events[c]=b),c.match(/^(%|#|~)/)){if(_.isString(b))throw new Error(a.id+":: Invalid listener for subscription: "+c+".\n"+"Define your callback with an anonymous function instead of a string.");if(!_.isFunction(b))throw new Error(a.id+":: Invalid listener for subscription: "+c);g.prototype.subscriptions[c]=b}else if("extendComponents"===c){var f={};_.each(b,function(b){if(!FRAMEWORK.components[b])throw new Error(a.id+" :: "+"Trying to define/extend this component from `"+b+"`, "+"but no component with that id can be found.");_.extend(f,FRAMEWORK.components[b])}),_.defaults(g.prototype,f)}}),FRAMEWORK.components[a.id]=g}},{"../utils/events":28,"../utils/shorthand":29,"../utils/utils":30}],15:[function(a,b){b.exports=function(){$("region[default],region[template],[data-region][default],[data-region][template]").each(function(){$e=$(this);var a=$e.attr("default")||$e.attr("template");$e.attr("contents",a)}),$("region[contents],[data-region][contents]").each(function(){FRAMEWORK.Region.fromElement(this)})}},{}],16:[function(a,b){var c=a("../utils/utils");b.exports=function(){var a={};return $('script[type="text/template"]').each(function(b,d){var e=c.el2id(d,!0);a[e]=$(d).html(),a[e]=a[e].replace(/^\s+/,""),a[e]=a[e].replace(/\s+$/,""),$(d).remove()}),a}},{"../utils/utils":30}],17:[function(a,b){var c=a("../logger/index"),d=a("../define/buildDefinition"),e=a("./buildPrototype"),f=a("./collectTemplates"),g=a("./collectRegions"),h=a("../router/index");b.exports=function(a,b){!b&&_.isFunction(a)&&(b=a),_.isPlainObject(a)||(a={}),FRAMEWORK.options.production&&(FRAMEWORK.options.logLevel="silent"),new c,_.extend(FRAMEWORK.data,a.data||{}),_.extend(FRAMEWORK.templates,a.templates||{}),_.each(FRAMEWORK._defineQueue,d),_.extend(FRAMEWORK.components,a.components||{}),FRAMEWORK.componentDefs=_.clone(FRAMEWORK.components),$(function(){_.extend(FRAMEWORK.templates,f()),_.each(FRAMEWORK.components,e),g();var c=_.debounce(function(){FRAMEWORK.trigger("%window:resize")},FRAMEWORK.options.throttleWindowResize||0);$(window).resize(c),h(),FRAMEWORK.history.start(_.defaults({pushState:void 0,hashChange:void 0,root:void 0},a)),b&&b()})}},{"../define/buildDefinition":9,"../logger/index":12,"../router/index":26,"./buildPrototype":14,"./collectRegions":15,"./collectTemplates":16}],18:[function(a,b){b.exports=function(a,b){return this.insert(this._children.length,a,b)}},{}],19:[function(a,b){b.exports=function(a,b){return this.empty(),this.append(a,b)}},{}],20:[function(a,b){b.exports=function(){for(FRAMEWORK.debug(this.parent.id+" :: Emptying region: "+this.id);this._children.length>0;)this.remove(0)}},{}],21:[function(a,b){var c=a("../utils/utils");b.exports=function(a,b){b=b||{id:"*"};var d,e=new FRAMEWORK.Region({id:c.el2id(a),$el:$(a),parent:b}),f=$(a).attr("contents"),g=1;return FRAMEWORK.options.shortcut.count&&(d=$(a).attr("count"),d&&(g=d)),FRAMEWORK.debug(b.id+" :-: Instantiated new region"+(e.id?" `"+e.id+"`":"")+(f?" and populated it with"+(g>1?g+" instances of":" 1")+" `"+f+"`":"")+"."),FRAMEWORK.options.shortcut.template&&f&&e.append(f),e}},{"../utils/utils":30}],22:[function(a,b){var c=a("./insert"),d=a("./remove"),e=a("./empty"),f=a("./append"),g=a("./attach"),h=a("./prepend"),i=a("./fromElement");Region=b.exports=function(a){if(_.extend(this,FRAMEWORK.Events),a||(a={}),!a.$el)throw new Error("Trying to instantiate region with no $el!");if(_.extend(this,a),!(this.id||this.$el.attr("default")||this.$el.attr("template")||this.$el.attr("contents")))throw new Error(this.parent.id+" :: Either `data-id`, `contents`, or both "+"must be specified on regions. \n"+'e.g. <region data-id="foo" template="SomeComponent"></region>');this._children=[],_.bindAll(this),FRAMEWORK.regions[this.id]=this},Region.fromElement=function(a,b){return i(a,b)},Region.prototype.remove=function(a){return d.call(this,a)},Region.prototype.empty=function(){return e.call(this)},Region.prototype.insert=function(a,b,d){return c.call(this,a,b,d)},Region.prototype.append=function(a,b){return f.call(this,a,b)},Region.prototype.attach=function(a,b){return g.call(this,a,b)},Region.prototype.prepend=function(a,b){return h.call(this,a,b)}},{"./append":18,"./attach":19,"./empty":20,"./fromElement":21,"./insert":23,"./prepend":24,"./remove":25}],23:[function(a,b){b.exports=function(a,b,c){var d="";if(a||_.isFinite(a)?b||(d+=this.id+".insert() :: No componentId specified!"):d+=this.id+".insert() :: No atIndex specified!",d)throw new Error(d+"\nUsage: append(atIndex, componentId, [properties])");var e;if("string"==typeof b){var f=FRAMEWORK.components[b];if(!f){var g=FRAMEWORK.templates[b];if(!g)throw new Error("In "+(this.id||"Anonymous region")+":: Trying to attach "+b+", but no component or template exists with that id.");f=FRAMEWORK.Component.extend({id:b,template:g})}e=new f(_.extend({$outlet:this.$el},c||{}))}else e=b,e.$outlet=this.$el;e.parentRegion=this,e.model||(e.model=this.parent.model?this.parent.model:new Backbone.Model),e.render(a),this._children.splice(a,0,e);var h=this.parent.id+" :: Inserted "+b+" into ";return h+=this.id?"region: "+this.id+" at index "+a:"anonymous region at index "+a,FRAMEWORK.verbose(h),e}},{}],24:[function(a,b){b.exports=function(a,b){return this.insert(0,a,b)}},{}],25:[function(a,b){b.exports=function(a){if(!a&&!_.isFinite(a))throw new Error(this.id+".remove() :: No atIndex specified! \nUsage: remove(atIndex)");var b=this._children.splice(a,1);if(!b[0])throw new Error(this.id+".remove() :: Trying to remove a component that doesn't exist at index "+a);b[0].close(),FRAMEWORK.debug(this.parent.id+" :: Removed component at index "+a+" from region: "+this.id)}},{}],26:[function(a,b){b.exports=function(){var a=new FRAMEWORK.Router;a.route(/(.*)/,"route",function(a){a||(a=""),FRAMEWORK.trigger("#"+a)}),FRAMEWORK.navigate=FRAMEWORK.history.navigate}},{}],27:[function(a,b){var c=a("./events"),d={flagBoundEvents:function(a){var b=c.parse(a.events,{only:["click","touch","touchstart","touchend"]});if(!(b.length<1)){var d=c.getElements(b,a),e="click";d.attr("data-"+FRAMEWORK.options.frameworkId+"-events",e),FRAMEWORK.verbose(a.id+" :: "+"Disabled user text selection on elements w/ click/touch events:",b,d)}}};b.exports=d},{"./events":28}],28:[function(a,b){a("./utils.js");var c={parse:function(a,b){var d,e=_.keys(a||{}),f=[];return d=b.only,e=_.filter(e,function(a){var b=c.parseDOMEvent(a);return f.push(b),d?_.contains(d,b.name):!0}),f},getElements:function(a,b){b=b||{$:$};var c=$();return _.each(a,function(a){var d=a.selector?b.$(a.selector):b.$el;c=c.add(d)},this),c},parseDOMEvent:_.memoize(function(a){var b=a.match(this["/DOMEvent/"]);return b&&b[1]?{name:b[1],selector:b[3]}:!1}),names:["error","scroll","click","dblclick","mousedown","mouseup","hover","mouseenter","mouseleave","mouseover","mouseout","mousemove","keydown","keyup","keypress","blur","change","focus","focusin","focusout","select","submit","touchstart","touchend","touchmove","touchcancel","touch","rightclick","clickoutside"]};c["/DOMEvent/"]=new RegExp("^("+_.reduce(c.names,function(a,b,c){return 0===c?a+b:a+"|"+b},"")+")( (.+))?$"),b.exports=c},{"./utils.js":30}],29:[function(a,b){b.exports=function(a,b){var c,d;if(_.isFunction(a)&&("collection"===b||"model"===b))return a();if(!_.isString(a))return a;if((c=a.match(/^##(.*[^.\s])/))&&c[1]?d=function(){var a=c[1];FRAMEWORK.history.navigate(a,{trigger:!0,replace:!0})}:(c=a.match(/^#(.*[^.\s]+)/))&&c[1]?d=function(){var a=c[1];FRAMEWORK.history.navigate(a,{trigger:!0})}:(c=a.match(/^(%.*[^.\s])/))&&c[1]?d=function(){var a=c[1];FRAMEWORK.verbose(this.id+" :: Triggering event ("+a+")..."),FRAMEWORK.trigger(a)}:(c=a.match(/^!!!\s*(.*[^.\s])?/))?d=function(a){var b=c&&c[1]||"Debug alert (!!!) triggered!";b+="\n\nDiagnostics\n========================\n",a&&a.currentTarget&&(b+="e.currentTarget :: "+a.currentTarget),this.id&&(b+="this.id :: "+this.id),alert(b)}:(c=a.match(/^>>>\s*(.*[^.\s])?/))?d=function(){var a=c&&c[1]||"Log message (>>>) triggered!";FRAMEWORK.log(a)}:(c=a.match(/^(.+)@(.*[^.\s])/))&&c[1]&&c[2]?d=function(){FRAMEWORK.verbose(this.id+" :: Attaching `"+c[2]+"` to `"+c[1]+"`...");var a=c[1],b=c[2];this[a].attach(b)}:(c=a.match(/^\+\s*\.(.*[^.\s])/))&&c[1]?d=function(){FRAMEWORK.verbose(this.id+" :: Adding class ("+c[1]+")..."),this.$el.addClass(c[1])}:(c=a.match(/^\-\s*\.(.*[^.\s])/))&&c[1]?d=function(){FRAMEWORK.verbose(this.id+" :: Removing class ("+c[1]+")..."),this.$el.removeClass(c[1])}:(c=a.match(/^\!\s*\.(.*[^.\s])/))&&c[1]&&(d=function(){FRAMEWORK.verbose(this.id+" :: Toggling class ("+c[1]+")..."),this.$el.toggleClass(c[1])}),d){FRAMEWORK.verbose("Interpreting meaning from shorthand :: `"+a+"`...");var e=d;return a.match(/\.\s*$/)&&(e=function(b){d.apply(this),b&&b.stopPropagation?b.stopPropagation():FRAMEWORK.warn(this.id+" :: Trailing `.` shorthand was used to invoke an "+'e.stopPropagation(), but "'+a+'" was not triggered by a DOM event!\n'+"Probably best to double-check this was what you meant to do.")}),e}return a}},{}],30:[function(a,b){var c={el2id:function(a,b){var c=$(a).attr("id"),d=$(a).attr("data-id"),e=$(a).attr("contents");if(c&&d)throw new Error(c+" :: Cannot set both `id` and `data-id`!  Please use one or the other.  (data-id is safest)");if(b&&!c&&!d)throw new Error("No id specified in element where it is required:\n"+a);return c||d||e},objMap:function(a,b){return _.object(_.keys(a),_.map(a,b))}};b.exports=c},{}]},{},[11]);